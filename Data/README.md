# Dynamic Data Ingestion Model for Financial Securities

## Overview

This project implements a dynamic data ingestion model for financial securities, featuring a hybrid indicator service that leverages TA-Lib for performance and a pure-Python fallback for portability. It also includes modules for data fetching, dynamic code adjustment, Gemini integration, and machine learning model selection.

## Installation

1.  **Create a virtual environment (recommended):**
    ```bash
    python -m venv .venv
    ```

2.  **Activate the virtual environment:**
    *   **Windows:**
        ```bash
        .venv\Scripts\activate
        ```
    *   **macOS/Linux:**
        ```bash
        source .venv/bin/activate
        ```

3.  **Install core dependencies:**
    ```bash
    pip install -r Data/requirements.txt
    ```

## Optional: TA-Lib Installation

TA-Lib is a high-performance technical analysis library written in C. Its Python wrapper provides significant speed advantages for indicator calculations. Installation requires the C library to be present on your system.

**Reference:** [https://github.com/TA-Lib/ta-lib-python](https://github.com/TA-Lib/ta-lib-python)

### Platform-specific instructions:

*   **Windows:**
    1.  Download the TA-Lib C library from [http://prdownloads.sourceforge.net/ta-lib/ta-lib-0.4.0-msvc.zip](http://prdownloads.sourceforge.net/ta-lib/ta-lib-0.4.0-msvc.zip).
    2.  Unzip the file to `C:\ta-lib`.
    3.  Add `C:\ta-lib\bin` to your system's PATH environment variable.
    4.  Install the Python wrapper: `pip install TA-Lib`

*   **Conda (Windows, macOS, Linux):**
    ```bash
    conda install -c conda-forge ta-lib
    ```

*   **Debian/Ubuntu:**
    ```bash
    sudo apt-get install build-essential python3-dev
    wget http://prdownloads.sourceforge.net/ta-lib/ta-lib-0.4.0-src.tar.gz
    tar -xzf ta-lib-0.4.0-src.tar.gz
    cd ta-lib/
    ./configure --prefix=/usr
    make
    sudo make install
    pip install TA-Lib
    ```

*   **macOS (using Homebrew):**
    ```bash
    brew install ta-lib
    pip install TA-Lib
    ```

## Usage Example

```python
from AlgoAgent.Data.main import DataIngestionModel

model = DataIngestionModel()

# Example request
df = model.ingest_and_process(
    ticker="AAPL",
    required_indicators=[{"name":"RSI","timeperiod":14},{"name":"MACD","fastperiod":12,"slowperiod":26,"signalperiod":9}],
    period="60d",
    interval="1h",
)

# df will contain original OHLCV + new columns: RSI, MACD, MACD_SIGNAL, MACD_HIST
```

## API Contracts

### `compute_indicator(name, df, params=None)`

*   **Input:**
    *   `name` (str): The name of the indicator (e.g., "RSI", "MACD").
    *   `df` (pandas.DataFrame): A DataFrame with a DatetimeIndex and columns: `Open`, `High`, `Low`, `Close`, `Volume`.
    *   `params` (dict, optional): A dictionary of parameters specific to the indicator (e.g., `{'timeperiod': 14}`).
*   **Output:**
    *   `(result_df, metadata)`:
        *   `result_df` (pandas.DataFrame): A DataFrame with the same index as the input `df` and new columns containing the computed indicator values.
        *   `metadata` (dict): A dictionary containing:
            *   `'source_hint'` (str): Indicates the implementation used (`'talib'`, `'ta'`, or `'custom'`).
            *   `'params'` (dict): The actual parameters used for the computation (including defaults).
            *   `'version'` (str): The version of the library used (if applicable).

### `describe_indicator(name)`

*   **Input:**
    *   `name` (str): The name of the indicator.
*   **Output:**
    *   `dict`: A dictionary containing metadata about the indicator, such as:
        *   `'inputs'` (list): Required input columns (e.g., `['close']`).
        *   `'outputs'` (list): Names of the output columns generated by the indicator.
        *   `'defaults'` (dict): Default parameters for the indicator.
        *   `'notes'` (str): Any additional notes or descriptions.
