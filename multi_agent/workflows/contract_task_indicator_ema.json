{
  "contract_id": "contract_task_indicator_ema",
  "name": "Indicator Loading - 20 EMA and 50 EMA",
  "description": "Design a contract for a function to compute Exponential Moving Averages (EMA) for given series and periods. This contract specifically supports the calculation of 20-period and 50-period EMAs, ensuring accuracy against known values.",
  "interfaces": [
    {
      "name": "compute_ema",
      "params": [
        {
          "name": "series",
          "type": "List[float]",
          "description": "A list of numerical values (e.g., closing prices) for which to compute the EMA."
        },
        {
          "name": "period",
          "type": "int",
          "description": "The period over which to calculate the EMA. Must be a positive integer."
        }
      ],
      "returns": "List[float]",
      "docstring": "Computes the Exponential Moving Average (EMA) for a given series and period.\n\nThe EMA is calculated using the formula: EMA_today = (Price_today * K) + (EMA_yesterday * (1 - K)),\nwhere K = 2 / (period + 1).\n\nThe first EMA value is typically initialized as the Simple Moving Average (SMA) of the first 'period' values.\nFor the first 'period - 1' elements, the EMA will be null (or NaN) as there isn't enough data to compute the initial SMA.\n\nArgs:\n    series (List[float]): The input series of values.\n    period (int): The EMA period.\n\nReturns:\n    List[float]: A list of EMA values. The list will have the same length as the input series.\n                 The first 'period - 1' values will be null.\n\nRaises:\n    ValueError: If 'period' is less than 1."
    }
  ],
  "data_models": [],
  "examples": [
    {
      "name": "test_compute_ema_normal_case",
      "description": "Calculates EMA for a standard series with a valid period.",
      "input": {
        "series": [
          10.0,
          11.0,
          12.0,
          13.0,
          14.0,
          15.0
        ],
        "period": 3
      },
      "expected": {
        "ema_values": [
          null,
          null,
          11.0,
          12.0,
          13.0,
          14.0
        ]
      },
      "notes": "First EMA (at index 2) is SMA of [10,11,12] = 11. K = 2/(3+1) = 0.5.\nEMA[3] = (13*0.5) + (11*0.5) = 12.0.\nEMA[4] = (14*0.5) + (12*0.5) = 13.0.\nEMA[5] = (15*0.5) + (13*0.5) = 14.0."
    },
    {
      "name": "test_compute_ema_short_series",
      "description": "Handles a series shorter than the specified period.",
      "input": {
        "series": [
          10.0,
          11.0
        ],
        "period": 3
      },
      "expected": {
        "ema_values": [
          null,
          null
        ]
      },
      "notes": "Not enough data to compute even the initial SMA, so all EMA values are null."
    },
    {
      "name": "test_compute_ema_period_one",
      "description": "Tests EMA with a period of 1, which should return the original series.",
      "input": {
        "series": [
          10.0,
          11.0,
          12.0
        ],
        "period": 1
      },
      "expected": {
        "ema_values": [
          10.0,
          11.0,
          12.0
        ]
      },
      "notes": "K = 2/(1+1) = 1.0. EMA_today = Price_today * 1.0 + EMA_yesterday * 0.0 = Price_today."
    },
    {
      "name": "test_compute_ema_invalid_period",
      "description": "Tests error handling for an invalid period (less than 1).",
      "input": {
        "series": [
          10.0,
          11.0,
          12.0
        ],
        "period": 0
      },
      "expected": {
        "error_type": "ValueError",
        "error_message_contains": "Period must be at least 1"
      },
      "notes": "The function should raise a ValueError for invalid input."
    },
    {
      "name": "test_compute_ema_20_period_with_known_data",
      "description": "Tests 20-period EMA against a longer series with pre-calculated expected values.",
      "input": {
        "series_fixture": "sample_prices_long.json",
        "period": 20
      },
      "expected": {
        "ema_values_fixture": "sample_prices_long.json",
        "key_path": "expected_emas.ema_20"
      },
      "notes": "This test uses a fixture for a longer price series and its corresponding pre-calculated 20-period EMA values for robust validation."
    },
    {
      "name": "test_compute_ema_50_period_with_known_data",
      "description": "Tests 50-period EMA against a longer series with pre-calculated expected values.",
      "input": {
        "series_fixture": "sample_prices_long.json",
        "period": 50
      },
      "expected": {
        "ema_values_fixture": "sample_prices_long.json",
        "key_path": "expected_emas.ema_50"
      },
      "notes": "This test uses a fixture for a longer price series and its corresponding pre-calculated 50-period EMA values for robust validation."
    }
  ],
  "test_skeleton": {
    "file_path": "tests/test_indicators.py",
    "required_imports": [
      "pytest",
      "json",
      "math",
      "pathlib",
      "your_module.indicators"
    ],
    "fixture_functions": [
      {
        "name": "load_json_fixture",
        "description": "A pytest fixture to load JSON data from a specified path.",
        "code_example": "import pytest\nimport json\nfrom pathlib import Path\n\n@pytest.fixture\ndef load_json_fixture():\n    def _loader(filename):\n        filepath = Path(__file__).parent.parent / 'fixtures' / filename\n        with open(filepath, 'r') as f:\n            return json.load(f)\n    return _loader"
      },
      {
        "name": "sample_prices_long",
        "description": "Provides a long series of sample prices and pre-calculated EMA values.",
        "code_example": "@pytest.fixture\ndef sample_prices_long(load_json_fixture):\n    return load_json_fixture('sample_prices_long.json')"
      }
    ],
    "test_functions": [
      "def test_compute_ema_normal_case(): ...",
      "def test_compute_ema_short_series(): ...",
      "def test_compute_ema_period_one(): ...",
      "def test_compute_ema_invalid_period(): ...",
      "def test_compute_ema_20_period_with_known_data(sample_prices_long): ...",
      "def test_compute_ema_50_period_with_known_data(sample_prices_long): ..."
    ],
    "pytest_commands": [
      "pytest tests/test_indicators.py",
      "pytest --cov=your_module tests/"
    ]
  },
  "fixtures": [
    "fixtures/sample_prices_long.json"
  ],
  "created_at": "2025-11-20T16:25:08.945078"
}